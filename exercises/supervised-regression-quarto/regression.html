<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Exercise 1 – ML Basics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="regression_files/libs/clipboard/clipboard.min.js"></script>
<script src="regression_files/libs/quarto-html/quarto.js"></script>
<script src="regression_files/libs/quarto-html/popper.min.js"></script>
<script src="regression_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="regression_files/libs/quarto-html/anchor.min.js"></script>
<link href="regression_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="regression_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="regression_files/libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="regression_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="regression_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="regression_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="regression_files/libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#exercise-1-hro-in-coding-frameworks" id="toc-exercise-1-hro-in-coding-frameworks" class="nav-link active" data-scroll-target="#exercise-1-hro-in-coding-frameworks">Exercise 1: HRO in coding frameworks</a></li>
  <li><a href="#exercise-2-loss-functions-for-regression-tasks" id="toc-exercise-2-loss-functions-for-regression-tasks" class="nav-link" data-scroll-target="#exercise-2-loss-functions-for-regression-tasks">Exercise 2: Loss functions for regression tasks</a></li>
  <li><a href="#exercise-3-polynomial-regression" id="toc-exercise-3-polynomial-regression" class="nav-link" data-scroll-target="#exercise-3-polynomial-regression">Exercise 3: Polynomial regression</a></li>
  <li><a href="#exercise-4-predicting-abalone" id="toc-exercise-4-predicting-abalone" class="nav-link" data-scroll-target="#exercise-4-predicting-abalone">Exercise 4: Predicting <code>abalone</code></a></li>
  </ul>
<div class="quarto-alternate-notebooks"><h2>Notebooks</h2><ul><li><a href="_r.ipynb.html"><i class="bi bi-journal-code"></i>Notebook for R</a></li><li><a href="_python.ipynb.html"><i class="bi bi-journal-code"></i>Notebook for Python</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Exercise 1 – ML Basics</h1>
<p class="subtitle lead"><a href="https://slds-lmu.github.io/i2ml/">Introduction to Machine Learning</a></p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="hidden">
<p>$$ </p>
% math spaces % N, naturals % Z, integers % Q, rationals % R, reals % C, complex % C, space of continuous functions % machine numbers % maximum error % counting / finite sets % set 0, 1 % set -1, 1 % unit interval % basic math stuff % x tilde % argmax % argmin % argmax with limits % argmin with limits<br>
% sign, signum % I, indicator % O, order
% partial derivative
% floor
% ceiling % sums and products % summation from i=1 to n % summation from i=1 to m % summation from j=1 to p % summation from j=1 to p % summation from i=1 to k % summation from k=1 to g % summation from j=1 to g % mean from i=1 to n % mean from i=1 to n % mean from k=1 to g % product from i=1 to n % product from k=1 to g % product from j=1 to p % linear algebra % 1, unitvector % 0-vector % I, identity % diag, diagonal % tr, trace % span
% &lt;.,.&gt;, scalarproduct
% short pmatrix command % matrix A % error term for vectors % basic probability + stats % P, probability % E, expectation % Var, variance % Cov, covariance % Corr, correlation % N of the normal distribution % dist with i.i.d superscript
<p>% … is distributed as …</p>
% X, input space % Y, output space % set from 1 to n % set from 1 to p % set from 1 to g % P_xy % E_xy: Expectation over random variables xy % vector x (bold) % vector x-tilde (bold) % vector y (bold) % observation (x, y) % (x1, …, xp) % Design matrix % The set of all datasets % The set of all datasets of size n % D, data % D_n, data of size n % D_train, training set % D_test, test set
% (x^i, y^i), i-th observation % {(x1,y1)), …, (xn,yn)}, data % Def. of the set of all datasets of size n % Def. of the set of all datasets % {x1, …, xn}, input data % {y1, …, yn}, input data % (y1, …, yn), vector of outcomes
% x^i, i-th observed value of x
<p>% y^i, i-th observed value of y % (x1^i, …, xp^i), i-th observation vector % x_j, j-th feature % (x^1_j, …, x^n_j), j-th feature vector % Basis transformation function phi % Basis transformation of xi: phi^i := phi(xi)</p>
<p>%%%%%% ml - models general % lambda vector, hyperconfiguration vector % Lambda, space of all hpos % Inducer / Inducing algorithm % Set of all datasets times the hyperparameter space % Set of all datasets times the hyperparameter space % Inducer / Inducing algorithm % Inducer, inducing algorithm, learning algorithm</p>
% continuous prediction function f % True underlying function (if a statistical model is assumed) % True underlying function (if a statistical model is assumed) % f(x), continuous prediction function % f with domain and co-domain % hypothesis space where f is from % Bayes-optimal model % Bayes-optimal model
<p>% f_j(x), discriminant component function % f hat, estimated prediction function % fhat(x) % f(x | theta) % f(x^(i)) % f(x^(i)) % f(x^(i) | theta) % fhat_D, estimate of f based on D % fhat_Dtrain, estimate of f based on D %model learned on Dn with hp lambda %model learned on D with hp lambda %model learned on Dn with optimal hp lambda %model learned on D with optimal hp lambda</p>
<p>% discrete prediction function h % h(x), discrete prediction function % h hat % hhat(x) % h(x | theta) % h(x^(i)) % h(x^(i) | theta) % Bayes-optimal classification model % Bayes-optimal classification model</p>
<p>% yhat % yhat for prediction of target % yhat^(i) for prediction of ith targiet </p>
% theta % theta hat % theta vector % theta vector hat
%
<p>% %theta learned on Dn with hp lambda %theta learned on D with hp lambda % min problem theta % argmin theta</p>
<p>% densities + probabilities % pdf of x % p % p(x) % pi(x|theta), pdf of x given theta % pi(x^i|theta), pdf of x given theta % pi(x^i), pdf of i-th x</p>
<p>% pdf of (x, y) % p(x, y) % p(x, y | theta) % p(x^(i), y^(i) | theta)</p>
% pdf of x given y
% p(x | y = k)
% log p(x | y = k)
<p>% p(x^i | y = k)</p>
% prior probabilities
% pi_k, prior
<p>% log pi_k, log of the prior % Prior probability of parameter theta</p>
% posterior probabilities % P(y = 1 | x), post. prob for y=1
% P(y = k | y), post. prob for y=k % pi with domain and co-domain % Bayes-optimal classification model % Bayes-optimal classification model % pi(x), P(y = 1 | x) % pi, bold, as vector
% pi_k(x), P(y = k | x)
% pi_k(x | theta), P(y = k | x, theta) % pi(x) hat, P(y = 1 | x) hat
% pi_k(x) hat, P(y = k | x) hat % pi(x^(i)) with hat
<p>% pi_k(x^(i)) with hat % p(y | x, theta) % p(y^i |x^i, theta) % log p(y | x, theta) % log p(y^i |x^i, theta)</p>
% probababilistic
<p>% Bayes rule % mean vector of class-k Gaussian (discr analysis)</p>
<p>% residual and margin % residual, stochastic % epsilon^i, residual, stochastic % residual, estimated % y f(x), margin % y^i f(x^i), margin % estimated covariance matrix % estimated covariance matrix for the j-th class</p>
<p>% ml - loss, risk, likelihood % L(y, f), loss function % L(y, pi), loss function % L(y, f(x)), loss function % loss of observation % loss with f parameterized % loss of observation with f parameterized % loss of observation with f parameterized % loss in classification % loss in classification % loss of observation in classification % loss with pi parameterized % loss of observation with pi parameterized % L(y, h(x)), loss function on discrete classes % L(r), loss defined on residual (reg) / margin (classif) % L1 loss % L2 loss % Bernoulli loss for -1, +1 encoding % Bernoulli loss for 0, 1 encoding % cross-entropy loss % Brier score % R, risk % R(f), risk % risk def (expected loss) % R(theta), risk % R_emp, empirical risk w/o factor 1 / n % R_emp, empirical risk w/ factor 1 / n % R_emp(f) % R_emp(theta) % R_reg, regularized risk % R_reg(theta) % R_reg(f) % hat R_reg(theta) % hat R_emp(theta) % L, likelihood % L(theta), likelihood % L(theta|x), likelihood % l, log-likelihood % l(theta), log-likelihood % l(theta|x), log-likelihood % training error % test error % avg training error</p>
<p>% lm % linear model % OLS estimator in LM $$</p>
</div>
<section id="exercise-1-hro-in-coding-frameworks" class="level2">
<h2 class="anchored" data-anchor-id="exercise-1-hro-in-coding-frameworks">Exercise 1: HRO in coding frameworks</h2>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Learning goals">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning goals
</div>
</div>
<div class="callout-body-container callout-body">
<p>TBD</p>
</div>
</div>
<p>Throughout the lecture, we will frequently use the <code>R</code> package <code>mlr3</code>, resp. the <code>Python</code> package <code>sklearn</code>, and its descendants, providing an integrated ecosystem for all common machine learning tasks. Let’s recap the HRO principle and see how it is reflected in either <code>mlr3</code> or <code>sklearn</code>. An overview of the most important objects and their usage, illustrated with numerous examples, can be found at <a href="https://mlr3book.mlr-org.com/">the <code>mlr3</code> book</a> and <a href="https://scikit-learn.org/stable/index.html">the <code>scikit</code> documentation</a>.</p>
<hr>
<p>How are the key concepts (i.e., hypothesis space, risk and optimization) you learned about in the lecture videos implemented?</p>
<details>
<summary>
<strong>Solution</strong>
</summary>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="quarto-embed-nb-cell">
<div class="cell" data-outputid="1e3de9e3-e89d-46f5-b8b6-0327f3d35b13" data-execution_count="3">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You initialize your "learner" or model with its properties defined by the</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters, e.g.,:</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lrn</span>(<span class="st">"regr.lm"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Before training them on actual data, they just contain information on the</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># functional form of f. Once a learner has been trained we can examine the</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters of the resulting model.</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(model)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> X <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">4</span>, <span class="at">n =</span> <span class="fu">length</span>(X))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> X, <span class="at">y =</span> y)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>task <span class="ot">&lt;-</span> TaskRegr<span class="sc">$</span><span class="fu">new</span>(<span class="at">id =</span> <span class="st">"mytask"</span>, <span class="at">backend =</span> dt, <span class="at">target =</span> <span class="st">"y"</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimization happens rather implicitly as sklearn only acts as a wrapper for</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># existing implementations and calls package-specific optimization procedures</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># within the function `model.fit()`:</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>model<span class="sc">$</span><span class="fu">train</span>(task)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Model MSE: %f"</span>, model<span class="sc">$</span><span class="fu">predict_newdata</span>(dt)<span class="sc">$</span><span class="fu">score</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;LearnerRegrLM:regr.lm&gt;
* Model: -
* Parameters: list()
* Packages: mlr3, mlr3learners, stats
* Predict Types:  [response], se
* Feature Types: logical, integer, numeric, character, factor
* Properties: loglik, weights</code></pre>
</div>
<div id="hro-objects" class="cell-output cell-output-display">
'Model MSE: 15.104770'
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="quarto-embed-nb-cell">
<div id="hro-objects" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2023-11-06T15:54:34.964468968Z&quot;,&quot;start_time&quot;:&quot;2023-11-06T15:54:34.918473806Z&quot;}" data-outputid="d112da7f-6f97-4503-87bf-fc83a10fe8ea" data-execution_count="23">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># You initialize your "learner" or model with its properties defined by the</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters, e.g.,:</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> LinearRegression(fit_intercept<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Before training them on actual data, they just contain information on the</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># functional form of f. Once a learner has been trained we can examine the</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters of the resulting model.</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>, <span class="dv">8</span>, <span class="fl">0.01</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="op">-</span><span class="dv">1</span> <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>x <span class="op">+</span> np.random.normal(loc<span class="op">=</span><span class="fl">0.0</span>, scale<span class="op">=</span><span class="dv">4</span>, size<span class="op">=</span><span class="bu">len</span>(x))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Optimization happens rather implicitly as sklearn only acts as a wrapper for</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># existing implementations and calls package-specific optimization procedures</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># within the function `model.fit()`:</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>model.fit(x.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>),y) <span class="co"># reshape for one feature design matrix</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Model MSE: '</span>, metrics.mean_squared_error(y, model.predict(x.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)))</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>LinearRegression()
Model MSE:  15.461825608784347</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</details>
<hr>
<p>Have a look at<code>mlr3::tsk("iris")</code> / <code>sklearn.datasets.load_iris</code>. What attributes does this object store?</p>
<details>
<summary>
<strong>Solution</strong>
</summary>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="quarto-embed-nb-cell">
<div id="hro-task" class="cell" data-outputid="2ed0b5f9-5063-4d0a-a927-e3abd43da3fe" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>task_iris <span class="ot">&lt;-</span> <span class="fu">tsk</span>(<span class="st">"iris"</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Feature names: %s"</span>, task_iris<span class="sc">$</span>feature_names)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sprintf</span>(<span class="st">"Target name: %s"</span>, task_iris<span class="sc">$</span>target_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="hro-task-1" class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>'Feature names: Petal.Length'</li><li>'Feature names: Petal.Width'</li><li>'Feature names: Sepal.Length'</li><li>'Feature names: Sepal.Width'</li></ol>
</div>
<div id="hro-task-2" class="cell-output cell-output-display">
'Target name: Species'
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="quarto-embed-nb-cell">
<div id="hro-task" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2023-11-06T15:59:49.752734Z&quot;,&quot;start_time&quot;:&quot;2023-11-06T15:59:49.709545913Z&quot;}" data-outputid="4537e8c1-2543-4b62-cd79-0a2ea76b444f" data-execution_count="24">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> load_iris()</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> iris.data</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> iris.target</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>feature_names <span class="op">=</span> iris.feature_names</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>target_names <span class="op">=</span> iris.target_names</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Type of object iris:"</span>, <span class="bu">type</span>(iris))</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Feature names:"</span>, feature_names)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Target names:"</span>, target_names)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Shape of X and y</span><span class="ch">\n</span><span class="st">"</span>, X.shape, y.shape)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Type of X and y</span><span class="ch">\n</span><span class="st">"</span>, <span class="bu">type</span>(X), <span class="bu">type</span>(y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Type of object iris: &lt;class 'sklearn.utils._bunch.Bunch'&gt;
Feature names: ['sepal length (cm)', 'sepal width (cm)', 'petal length (cm)', 'petal width (cm)']
Target names: ['setosa' 'versicolor' 'virginica']

Shape of X and y
 (150, 4) (150,)

Type of X and y
 &lt;class 'numpy.ndarray'&gt; &lt;class 'numpy.ndarray'&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</details>
<hr>
<p>Instantiate a regression tree learner. What are the different settings for this learner?</p>
<details>
<summary>
<em>Hint</em>
</summary>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>Use <code>lrn("regr.rpart")</code> (<code>mlr3::mlr_learners$keys()</code> shows all available learners).</p>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>Use the <code>DecisionTreeRegressor</code> module and use <code>get_params()</code> to see all available settings.</p>
</div>
</div>
</div>
</details>
<details>
<summary>
<strong>Solution</strong>
</summary>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="quarto-embed-nb-cell">
<div id="hro-learner" class="cell" data-outputid="99b96b0d-0d39-4ab2-bb23-74313b8a8dfe" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List available learners in base mlr3 package</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>mlr_learners<span class="sc">$</span><span class="fu">keys</span>()</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect regression tree learner</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lrn</span>(<span class="st">"regr.rpart"</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># List configurable hyperparameters</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lrn</span>(<span class="st">"regr.rpart"</span>)<span class="sc">$</span>param_set</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="hro-learner-1" class="cell-output cell-output-display">
<style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class="list-inline"><li>'classif.cv_glmnet'</li><li>'classif.debug'</li><li>'classif.featureless'</li><li>'classif.glmnet'</li><li>'classif.kknn'</li><li>'classif.lda'</li><li>'classif.log_reg'</li><li>'classif.multinom'</li><li>'classif.naive_bayes'</li><li>'classif.nnet'</li><li>'classif.qda'</li><li>'classif.ranger'</li><li>'classif.rpart'</li><li>'classif.svm'</li><li>'classif.xgboost'</li><li>'clust.agnes'</li><li>'clust.ap'</li><li>'clust.cmeans'</li><li>'clust.cobweb'</li><li>'clust.dbscan'</li><li>'clust.diana'</li><li>'clust.em'</li><li>'clust.fanny'</li><li>'clust.featureless'</li><li>'clust.ff'</li><li>'clust.hclust'</li><li>'clust.kkmeans'</li><li>'clust.kmeans'</li><li>'clust.MBatchKMeans'</li><li>'clust.mclust'</li><li>'clust.meanshift'</li><li>'clust.pam'</li><li>'clust.SimpleKMeans'</li><li>'clust.xmeans'</li><li>'regr.cv_glmnet'</li><li>'regr.debug'</li><li>'regr.featureless'</li><li>'regr.glmnet'</li><li>'regr.kknn'</li><li>'regr.km'</li><li>'regr.lm'</li><li>'regr.nnet'</li><li>'regr.ranger'</li><li>'regr.rpart'</li><li>'regr.svm'</li><li>'regr.xgboost'</li></ol>
</div>
<div id="hro-learner-2" class="cell-output cell-output-display">
<pre><code>&lt;LearnerRegrRpart:regr.rpart&gt;: Regression Tree
* Model: -
* Parameters: xval=0
* Packages: mlr3, rpart
* Predict Types:  [response]
* Feature Types: logical, integer, numeric, factor, ordered
* Properties: importance, missings, selected_features, weights</code></pre>
</div>
<div id="hro-learner-3" class="cell-output cell-output-display">
<pre><code>&lt;ParamSet&gt;
                id    class lower upper nlevels        default value
 1:             cp ParamDbl     0     1     Inf           0.01      
 2:     keep_model ParamLgl    NA    NA       2          FALSE      
 3:     maxcompete ParamInt     0   Inf     Inf              4      
 4:       maxdepth ParamInt     1    30      30             30      
 5:   maxsurrogate ParamInt     0   Inf     Inf              5      
 6:      minbucket ParamInt     1   Inf     Inf &lt;NoDefault[3]&gt;      
 7:       minsplit ParamInt     1   Inf     Inf             20      
 8: surrogatestyle ParamInt     0     1       2              0      
 9:   usesurrogate ParamInt     0     2       3              2      
10:           xval ParamInt     0   Inf     Inf             10     0</code></pre>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="quarto-embed-nb-cell">
<div id="hro-learner" class="cell" data-executetime="{&quot;end_time&quot;:&quot;2023-11-06T16:06:31.753055060Z&quot;,&quot;start_time&quot;:&quot;2023-11-06T16:06:31.707252693Z&quot;}" data-outputid="4286b0df-816e-4702-f1e9-e109376f92b3" data-execution_count="25">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># help(DecisionTreeRegressor)</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect regression tree learner</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>rtree <span class="op">=</span> DecisionTreeRegressor() <span class="co"># default setting</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rtree)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># List configurable hyperparameters</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>[<span class="bu">print</span>(<span class="ss">f'</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>v<span class="sc">}</span><span class="ss">'</span>) <span class="cf">for</span> k, v <span class="kw">in</span> rtree.get_params().items()][<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>DecisionTreeRegressor()
ccp_alpha: 0.0
criterion: squared_error
max_depth: None
max_features: None
max_leaf_nodes: None
min_impurity_decrease: 0.0
min_samples_leaf: 1
min_samples_split: 2
min_weight_fraction_leaf: 0.0
random_state: None
splitter: best</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</details>
</section>
<section id="exercise-2-loss-functions-for-regression-tasks" class="level2">
<h2 class="anchored" data-anchor-id="exercise-2-loss-functions-for-regression-tasks">Exercise 2: Loss functions for regression tasks</h2>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Learning goals">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning goals
</div>
</div>
<div class="callout-body-container callout-body">
<p>TBD</p>
</div>
</div>
<p>In this exercise, we will examine loss functions for regression tasks somewhat more in depth.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>Consider the above linear regression task. How will the model parameters be affected by adding the new outlier point (orange) if you use <span class="math inline">\(L1\)</span> loss and <span class="math inline">\(L2\)</span> loss, respectively, in the empirical risk? (You do not need to actually compute the parameter values.)</p>
<details>
<summary>
<strong>Solution</strong>
</summary>
<p><span class="math inline">\(L2\)</span> loss penalizes vertical distances to the regression line <em>quadratically</em>, while <span class="math inline">\(L1\)</span> only considers the <em>absolute</em> distance. As the outlier point lies pretty far from the remaining training data, it will have a large loss with <span class="math inline">\(L2\)</span>, and the regression line will pivot to the bottom right to minimize the resulting empirical risk. A model trained with <span class="math inline">\(L1\)</span> loss is less susceptible to the outlier and will adjust only slightly to the new data.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="480"></p>
</div>
</div>
</details>
<hr>
<div class="cell">
<div class="cell-output-display">
<p><img src="regression_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="480"></p>
</div>
</div>
<p>The second plot visualizes another loss function popular in regression tasks, the so-called <em>Huber loss</em> (depending on <span class="math inline">\(\epsilon &gt; 0\)</span>; here: <span class="math inline">\(\epsilon = 5\)</span>). Describe how the Huber loss deals with residuals as compared to <span class="math inline">\(L1\)</span> and <span class="math inline">\(L2\)</span> loss. Can you guess its definition?</p>
<details>
<summary>
<strong>Solution</strong>
</summary>
The Huber loss combines the respective advantages of <span class="math inline">\(L1\)</span> and <span class="math inline">\(L2\)</span> loss: it is smooth and (once) differentiable like <span class="math inline">\(L2\)</span> but does not punish larger residuals as severely, leading to more robustness. It is simply a (weighted) piecewise combination of both losses, where <span class="math inline">\(\epsilon\)</span> marks where <span class="math inline">\(L2\)</span> transits to <span class="math inline">\(L1\)</span> loss. The exact definition is: <span class="math display">\[
  L\left(y, f(\mathbf{x})\right)= \begin{cases}
    \frac{1}{2}(y - f(\mathbf{x}))^2  &amp; \text{ if } |y - f(\mathbf{x})|\le \epsilon \\
    \epsilon |y - f(\mathbf{x})|-\frac{1}{2}\epsilon^2 \quad &amp; \text{ otherwise }
    \end{cases}, \quad \epsilon &gt; 0
  \]</span> In the plot we can see how the parabolic shape of the loss around 0 evolves into an absolute-value function at <span class="math inline">\(|y - f(\mathbf{x})|&gt; \epsilon = 5\)</span>.
</details>
</section>
<section id="exercise-3-polynomial-regression" class="level2">
<h2 class="anchored" data-anchor-id="exercise-3-polynomial-regression">Exercise 3: Polynomial regression</h2>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Learning goals">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning goals
</div>
</div>
<div class="callout-body-container callout-body">
<p>TBD</p>
</div>
</div>
<p>Assume the following (noisy) data-generating process from which we have observed 50 realizations: <span class="math display">\[y = -3 + 5 \cdot
\sin(0.4 \pi x) + \epsilon\]</span> with <span class="math inline">\(\epsilon \, \sim \mathcal{N}(0, 1)\)</span>.</p>
<hr>
<p>We decide to model the data with a cubic polynomial (including intercept term). State the corresponding hypothesis space.</p>
<details>
<summary>
<strong>Solution</strong>
</summary>
Cubic means degree 3, so our hypothesis space will look as follows: <span class="math display">\[\mathcal{H}= \{ f(\mathbf{x}~|~ \boldsymbol{\theta})= \theta_0 + \theta_1 x + \theta_2 x^2 + \theta_3 x^3
~|~ (\theta_0, \theta_1, \theta_2, \theta_3)^\top \in \mathbb{R}^4 \}\]</span>
</details>
<hr>
<p>State the empirical risk w.r.t. <span class="math inline">\(\boldsymbol{\theta}\)</span> for a member of the hypothesis space. Use <span class="math inline">\(L2\)</span> loss and be as explicit as possible.</p>
<details>
<summary>
<strong>Solution</strong>
</summary>
The empirical risk is: <span class="math display">\[\mathcal{R}_{\text{emp}}(\boldsymbol{\theta})= \sum_{i = 1}^{50} \left(y^{(i)}- \left[ \theta_0 + \theta_1 x^{(i)} +
\theta_2 \left( x^{(i)} \right)^2 + \theta_3 \left( x^{(i)} \right)^3 \right]
\right)^2\]</span>
</details>
<hr>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="Only for lecture group A">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Only for lecture group A
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>We can minimize this risk using gradient descent. Derive the gradient of the empirical risk w.r.t <span class="math inline">\(\boldsymbol{\theta}\)</span>.</p>
<details>
<summary>
<strong>Solution</strong>
</summary>
<p>We can find the gradient just as we did for an intermediate result when we derived the least-squares estimator:</p>
<span class="math display">\[\begin{align*}
  \nabla_{\boldsymbol{\theta}} \mathcal{R}_{\text{emp}}(\boldsymbol{\theta})&amp;=
  \frac{\partial{}}{\partial \boldsymbol{\theta}} \left \| \mathbf{y}- \mathbf{X}\boldsymbol{\theta}\right \|_2^2 \\
  &amp;= \frac{\partial{}}{\partial \boldsymbol{\theta}} \left( \left(\mathbf{y}- \mathbf{X}\boldsymbol{\theta}\right)^\top
  \left(\mathbf{y}- \mathbf{X}\boldsymbol{\theta}\right) \right) \\
  &amp;= - 2 \mathbf{X}^\top \mathbf{y}+ 2 \mathbf{X}^\top \mathbf{X}\boldsymbol{\theta}\\
  &amp;= 2 \cdot \left( - \mathbf{X}^\top \mathbf{y}+ \mathbf{X}^\top
  \mathbf{X}\boldsymbol{\theta}\right)
\end{align*}\]</span>
</details>
<hr>
<div class="callout callout-style-default callout-tip no-icon callout-titled" title="Only for lecture group A">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Only for lecture group A
</div>
</div>
<div class="callout-body-container callout-body">

</div>
</div>
<p>Using the result for the gradient, state the calculation to update the current parameter <span class="math inline">\(\boldsymbol{\theta}^{[t]}\)</span>.</p>
<details>
<summary>
<strong>Solution</strong>
</summary>
<p>Recall that the idea of gradient descent (!) is to traverse the risk surface in the direction of the gradient as we are in search for the minimum. Therefore, we will update our current parameter set <span class="math inline">\(\boldsymbol{\theta}^{[t]}\)</span> with the negative gradient of the current empirical risk w.r.t. <span class="math inline">\(\boldsymbol{\theta}\)</span>, scaled by learning rate (or step size) <span class="math inline">\(\alpha\)</span>:</p>
<p><span class="math display">\[\boldsymbol{\theta}^{[t +1]}= \boldsymbol{\theta}^{[t]}- \alpha \cdot \nabla_{\boldsymbol{\theta}} \mathcal{R}_{\text{emp}}(\boldsymbol{\theta}^{[t]}).\]</span></p>
<p>Note that the <span class="math inline">\(L2\)</span>-induced multiplicative constant of 2 in the gradient can simply be absorbed by <span class="math inline">\(\tilde \alpha := \tfrac{1}{2} \alpha\)</span>:</p>
<p><span class="math display">\[\begin{align*}
    \underbrace{\boldsymbol{\theta}^{[t +1]}}_{p \times 1} &amp;= \underbrace{\boldsymbol{\theta}^{[t]}}_{p \times 1} -
    \tilde \alpha \cdot \left( - \underbrace{\mathbf{X}^\top \phantom{y}}_{
    p \times n} \underbrace{\mathbf{y}}_{n \times 1} + \underbrace{
    \mathbf{X}^\top \mathbf{X}\phantom{y}}_{p \times p}
    \underbrace{\boldsymbol{\theta}^{[t]}\phantom{y}}_{p \times 1}
    \right) \\
    \begin{pmatrix} \theta_1 \\ \theta_2 \\ \vdots \\ \theta_p \end{pmatrix}^{[t + 1]} &amp;=
    \begin{pmatrix} \theta_1 \\ \theta_2 \\ \vdots \\ \theta_p \end{pmatrix}^{[t]} - \tilde \alpha
    \cdot \left( - \mathbf{X}^\top \mathbf{y}+ \mathbf{X}^\top \mathbf{X}
    \begin{pmatrix} \theta_1 \\ \theta_2 \\ \vdots \\ \theta_p \end{pmatrix}^{[t]} \right)
  \end{align*}\]</span></p>
<p>What actually happens here: we update each component of our current parameter vector <span class="math inline">\(\boldsymbol{\theta}^{[t]}\)</span> in the of the negative gradient, i.e., following the steepest downward slope, and also by an that depends on the value of the gradient.</p>
In order to see what that means it is helpful to recall that the gradient <span class="math inline">\(\nabla_{\boldsymbol{\theta}} \mathcal{R}_{\text{emp}}(\boldsymbol{\theta})\)</span> tells us about the effect (infinitesimally small) changes in <span class="math inline">\(\boldsymbol{\theta}\)</span> have on <span class="math inline">\(\mathcal{R}_{\text{emp}}(\boldsymbol{\theta})\)</span>. Therefore, gradient updates focus on influential components, and we proceed more quickly along the important dimensions.
</details>
<hr>
<p>You will not be able to fit the data perfectly with a cubic polynomial. Describe the advantages and disadvantages that a more flexible model class would have. Would you opt for a more flexible learner?</p>
<details>
<summary>
<strong>Solution</strong>
</summary>
<p>We see that, for example, the first model in exercise b) fits the data fairly well but not perfectly. Choosing a more flexible function (a polynomial of higher degree or a function from an entirely different, more complex, model class) might be advantageous:</p>
<ul>
<li><p>We would be able to trace the observations more closely if our function were less smooth, and thus reduce empirical risk. On the other hand, flexibility also has drawbacks:</p></li>
<li><p>Flexible model classes often have more parameters, making training harder.</p></li>
<li><p>We might run into a phenomenon called <em>overfitting</em>. Recall that our ultimate goal is to make predictions on <em>new</em> observations. However, fitting every quirk of the training observations – possibly caused by imprecise measurement or other factors of randomness/error – will not generalize so well to new data.</p></li>
</ul>
<p>In the end, we need to balance model fit and generalization. We will discuss the choice of hypotheses quite a lot since it is one of the most crucial design decisions in machine learning.</p>
</details>
</section>
<section id="exercise-4-predicting-abalone" class="level2">
<h2 class="anchored" data-anchor-id="exercise-4-predicting-abalone">Exercise 4: Predicting <code>abalone</code></h2>
<div class="callout callout-style-default callout-note no-icon callout-titled" title="Learning goals">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Learning goals
</div>
</div>
<div class="callout-body-container callout-body">
<p>TBD</p>
</div>
</div>
<p>We want to predict the age of an abalone using its longest shell measurement and its weight. The <code>abalone</code> data can be found here: <a href="https://archive.ics.uci.edu/ml/machine-learning-databases/abalone/abalone.data">https://archive.ics.uci.edu/ml/machine-learning-databases/abalone/abalone.data</a>.</p>
<p>Prepare the data as follows:</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="quarto-embed-nb-cell">
<div id="abalone-data" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Download data</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://archive.ics.uci.edu/ml/machine-learning-databases/abalone/abalone.data"</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>abalone <span class="ot">&lt;-</span> <span class="fu">read.table</span>(url, <span class="at">sep =</span> <span class="st">","</span>, <span class="at">row.names =</span> <span class="cn">NULL</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(abalone) <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sex"</span>, <span class="st">"longest_shell"</span>, <span class="st">"diameter"</span>, <span class="st">"height"</span>, <span class="st">"whole_weight"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"shucked_weight"</span>, <span class="st">"visceral_weight"</span>, <span class="st">"shell_weight"</span>, <span class="st">"rings"</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Reduce to relevant columns</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>abalone <span class="ot">&lt;-</span> abalone[, <span class="fu">c</span>(<span class="st">"longest_shell"</span>, <span class="st">"whole_weight"</span>, <span class="st">"rings"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p>Call <code>from sklearn.metrics import mean_absolute_error</code>.</p>
</div>
</div>
</div>
<hr>
<p>Plot <code>LongestShell</code> and <code>WholeWeight</code> on the <span class="math inline">\(x\)</span>- and <span class="math inline">\(y\)</span>-axis, respectively, and color points according to <code>Rings</code>.</p>
<details>
<summary>
<strong>Solution</strong>
</summary>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="quarto-embed-nb-cell">
<div class="cell" data-outputid="4039acb5-8be7-4ccf-e8e2-b90bf9e537c5" data-execution_count="7">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot weight vs shell length</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  abalone,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> longest_shell, <span class="at">y =</span> whole_weight, <span class="at">col =</span> rings)) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">scale_color_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"longest shell"</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"whole weight"</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Weight vs shell length for abalone data"</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="regression_files/figure-html/abalone-plot-output-1.png" id="abalone-plot" class="img-fluid"></p>
</div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>Call <code>from sklearn.metrics import mean_absolute_error</code>.</p>
</div>
</div>
</div>
</details>
<hr>
<p>Using <code>mlr3</code>/<code>sklearn</code>, fit a linear regression model to the data.</p>
<details>
<summary>
<strong>Solution</strong>
</summary>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="quarto-embed-nb-cell">
<div class="cell" data-outputid="81c76c9c-54dd-4f0c-cb5f-fae859552bc5" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mlr3)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify regression task</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>task_abalone <span class="ot">&lt;-</span> TaskRegr<span class="sc">$</span><span class="fu">new</span>(</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">id =</span> <span class="st">"abalone"</span>, <span class="at">backend =</span> abalone, <span class="at">target =</span> <span class="st">"rings"</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>task_abalone</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="abalone-task" class="cell-output cell-output-display">
<pre><code>&lt;TaskRegr:abalone&gt; (4177 x 3)
* Target: rings
* Properties: -
* Features (2):
  - dbl (2): longest_shell, whole_weight</code></pre>
</div>
</div>
</div>
<p>.</p>
<div class="quarto-embed-nb-cell">
<div id="abalone-predict" class="cell" data-outputid="1c9044e1-99f7-403f-e07e-f2b22ee430a4" data-execution_count="9">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mlr3)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mlr3learners)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up LM, train (by default, the target will be regressed on all features,</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># i.e., target ~ .)</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>learner_lm <span class="ot">&lt;-</span> mlr3<span class="sc">::</span><span class="fu">lrn</span>(<span class="st">"regr.lm"</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Model before training:"</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>learner_lm<span class="sc">$</span>model</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Train and predict</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>learner_lm<span class="sc">$</span><span class="fu">train</span>(task_abalone)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Model after training:"</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>learner_lm<span class="sc">$</span>model</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>pred_lm <span class="ot">&lt;-</span> learner_lm<span class="sc">$</span><span class="fu">predict</span>(task_abalone)</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Inspect predictions</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"Predictions:"</span>)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>pred_lm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Model before training:"
[1] "Model after training:"
[1] "Predictions:"</code></pre>
</div>
<div id="abalone-predict-1" class="cell-output cell-output-display">
<pre><code>NULL</code></pre>
</div>
<div id="abalone-predict-2" class="cell-output cell-output-display">
<pre><code>
Call:
stats::lm(formula = task$formula(), data = task$data())

Coefficients:
  (Intercept)  longest_shell   whole_weight  
        3.431         10.582          1.155  </code></pre>
</div>
<div id="abalone-predict-3" class="cell-output cell-output-display">
<pre><code>&lt;PredictionRegr&gt; for 4177 observations:
    row_ids truth  response
          1    15  8.840042
          2     7  7.395659
          3     9  9.821995
---                        
       4175     9 11.139128
       4176    10 11.309553
       4177    12 13.195460</code></pre>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<p>Call <code>from sklearn.metrics import mean_absolute_error</code>.</p>
</div>
</div>
</div>
</details>
<hr>
<p>Compare the fitted and observed targets visually.</p>
<details>
<summary>
<em>Hint</em>
</summary>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>Use <code>$autoplot()</code> from <code>mlr3viz</code>.</p>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>tbd</p>
</div>
</div>
</div>
</details>
<details>
<summary>
<strong>Solution</strong>
</summary>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="quarto-embed-nb-cell">
<div class="cell" data-outputid="671afa50-7950-45b8-8aa6-5341e7bbf2ed" data-execution_count="10">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mlr3viz)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Get nice visualization with a one-liner</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>mlr3viz<span class="sc">::</span><span class="fu">autoplot</span>(pred_lm) <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fu">max</span>(abalone<span class="sc">$</span>rings)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="regression_files/figure-html/abalone-viz-output-1.png" id="abalone-viz" class="img-fluid"></p>
</div>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<p>tbd</p>
</div>
</div>
</div>
</details>
<hr>
<p>Assess the model’s training loss in terms of MAE.</p>
<details>
<summary>
<em>Hint</em>
</summary>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<p>Call <code>$score()</code>, which accepts different <code>mlr_measures</code>, on the prediction object.</p>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<p>Call <code>from sklearn.metrics import mean_absolute_error</code>.</p>
</div>
</div>
</div>
</details>
<details>
<summary>
<strong>Solution</strong>
</summary>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true" href="">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false" href="">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="quarto-embed-nb-cell">
<div id="abalone-eval" class="cell" data-outputid="2e89e496-fc81-426e-8c5e-0eb41b21ceee" data-execution_count="11">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define MAE metric</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>mae <span class="ot">&lt;-</span> mlr3<span class="sc">::</span><span class="fu">msr</span>(<span class="st">"regr.mae"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Assess performance (MSE by default)</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>pred_lm<span class="sc">$</span><span class="fu">score</span>()</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>pred_lm<span class="sc">$</span><span class="fu">score</span>(mae)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="abalone-eval-1" class="cell-output cell-output-display">
<strong>regr.mse:</strong> 7.12552086050315
</div>
<div id="abalone-eval-2" class="cell-output cell-output-display">
<strong>regr.mae:</strong> 1.95066028734684
</div>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<p>tbd</p>
</div>
</div>
</div>
</details>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>